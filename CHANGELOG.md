# Git 自动提交插件 - 版本更新日志

## v1.0.0 - 数据存储重构 (2025-01-12)

### 🎉 重大更新：全新数据存储系统

这个版本对插件的数据存储方式进行了完全重构，提供更安全、更灵活的配置管理体验。

### ✨ 新功能

1. **独立数据文件**
   - 所有配置数据现在存储在独立的 `plugin-data.json` 文件中
   - 与插件代码完全分离，便于管理和分享

2. **API密钥加密存储**
   - 所有API密钥使用Base64编码存储
   - 不再以明文形式保存敏感信息

3. **自动数据迁移**
   - 自动检测并迁移localStorage中的旧配置
   - 无缝升级体验，无需手动操作

4. **增强的调试工具**
   - 新增"调试数据状态"命令
   - 新增"重置插件数据"命令
   - 更详细的状态信息输出

5. **迁移向导**
   - 首次运行时显示欢迎界面
   - 数据迁移完成后显示说明

### 🔧 改进

1. **更好的分享体验**
   - 现在只需复制 `main.js`、`styles.css`、`manifest.json` 三个文件
   - 接收方获得干净的初始状态插件

2. **增强的错误处理**
   - 更好的数据验证和错误恢复
   - 详细的错误信息和调试输出

3. **性能优化**
   - 减少localStorage的使用
   - 更高效的数据读写操作

### 🛠️ 技术改进

1. **新的数据管理器**
   - 统一的数据访问接口
   - 支持设置管理、模型配置、个性化偏好
   - 完整的CRUD操作支持

2. **更好的类型安全**
   - 完善的TypeScript类型定义
   - 严格的数据结构验证

3. **模块化架构**
   - 数据管理与业务逻辑分离
   - 更清晰的代码组织

### 📋 迁移说明

#### 自动迁移
- 插件会自动检测localStorage中的旧配置
- 自动迁移所有模型配置和设置
- 自动编码API密钥并清理旧数据

#### 手动操作（如需要）
- 使用"重置插件数据"命令恢复初始状态
- 使用"调试数据状态"命令查看当前配置
- 删除 `plugin-data.json` 文件可完全重置

### 🔒 安全改进

1. **密钥编码**
   - API密钥不再明文存储
   - 使用Base64编码保护敏感信息

2. **数据隔离**
   - 配置数据与插件代码完全分离
   - 减少意外数据泄露的风险

### 📁 文件结构变化

#### 新增文件
- `plugin-data.json` - 主要数据文件
- `data-manager.ts` - 数据管理器
- `new-model-config-manager.ts` - 新模型管理器
- `data-migration-modal.ts` - 迁移向导
- `DATA_STORAGE.md` - 数据存储说明

#### 修改文件
- `main.ts` - 集成新数据系统
- `ai-settings-components.ts` - 适配新管理器
- `model-config.ts` - 保留兼容性

### 🔍 调试命令

1. **调试AI配置**
   - 输出模型配置状态
   - 显示验证状态和默认模型

2. **调试数据状态**
   - 输出完整数据状态
   - 显示数据文件信息

3. **重置插件数据**
   - 恢复所有数据到初始状态
   - 清除所有配置

### ⚠️ 注意事项

1. **备份建议**
   - 升级前建议备份现有配置
   - 可使用导出功能保存配置

2. **分享须知**
   - 分享插件时不要包含 `plugin-data.json`
   - 确保API密钥不会意外泄露

3. **故障排除**
   - 如遇问题可删除数据文件重新开始
   - 使用调试命令获取详细信息

### 🚀 后续计划

1. **配置同步**
   - 计划支持云端配置同步
   - 多设备配置共享

2. **高级加密**
   - 考虑使用更强的加密算法
   - 支持用户自定义密钥

3. **配置模板**
   - 预设常用配置模板
   - 快速配置向导

---

### 升级指南

1. **自动升级**
   - 插件会自动处理数据迁移
   - 首次运行时会显示欢迎界面

2. **手动检查**
   - 使用"调试数据状态"验证迁移结果
   - 确认所有模型配置正常

3. **问题报告**
   - 如遇任何问题，请使用调试命令收集信息
   - 可通过GitHub Issues报告问题

感谢您使用 Git 自动提交插件！新的数据存储系统将为您提供更好的使用体验。
