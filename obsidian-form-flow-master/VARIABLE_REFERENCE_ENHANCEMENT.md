# Form Flow 变量引用功能增强说明

## 新增功能

我们为 Form Flow 插件增加了变量引用功能，现在不仅在"文本内容"区域可以引用表单字段，在以下位置也支持了变量引用：

### 1. 创建文件 - 文件路径
- 支持在文件路径中使用 `{{@字段名}}` 引用表单字段
- 输入 `@` 符号会自动触发字段检索功能
- 如果输入的是纯文件名（无路径分隔符和扩展名），会自动添加 `.md` 后缀

**示例：**
- 输入：`日记/{{@日期}}`
- 输入：`{{@项目名称}}` → 自动变成 `{{@项目名称}}.md`

### 2. 插入文本 - 目标文件路径
- 支持在目标文件路径中使用变量引用
- 同样支持 `@` 符号触发的自动完成
- 自动添加 `.md` 后缀功能

**示例：**
- 输入：`笔记/{{@分类}}/{{@标题}}`

### 3. 插入文本 - 标题
- 支持在标题字段中使用变量引用
- 可以动态生成标题内容

**示例：**
- 输入：`## {{@今日任务}} - {{@日期}}`

### 4. 更新属性 - 目标文件路径
- 支持在目标文件路径中使用变量引用
- 自动添加 `.md` 后缀功能

### 5. 更新属性 - 属性名和属性值
- 属性名称和属性值都支持变量引用
- 可以动态设置属性名和值

**示例：**
- 属性名：`{{@属性类型}}`
- 属性值：`{{@用户输入}} - 处理时间：{{date}}`

## 使用方法

1. **触发自动完成：** 在支持变量引用的输入框中输入 `@` 符号
2. **选择字段：** 从弹出的列表中选择需要引用的字段
3. **自动格式化：** 系统会自动将选择的字段格式化为 `{{@字段名}}` 格式
4. **文件名处理：** 纯文件名会自动添加 `.md` 后缀

## 技术实现

- 使用 CodeMirror 编辑器支持语法高亮和自动完成
- 集成了表单字段变量系统
- 支持内置变量（如 `{{date}}`、`{{time}}` 等）
- 保持了与原有文本内容区域相同的变量引用体验

## 注意事项

1. 变量引用格式必须是 `{{@字段名}}`
2. 字段名必须与表单中定义的字段名完全匹配
3. 自动添加 `.md` 后缀只适用于纯文件名（不包含路径分隔符和扩展名）
4. 变量会在表单提交时被实际的字段值替换
