# Form Flow 插件完整重启指南 - 解决缓存问题

## ✅ 已完成的更新
- ✅ 插件已重新构建并部署到：`C:\Code\Obsidian沙箱仓库\.obsidian\plugins\form-flow\`
- ✅ 所有Obsidian进程已强制关闭
- ✅ 插件文件已清空并重新复制
- ✅ 文件时间戳：2025/8/20 2:39:16
- ✅ 新版本包含四个问题的完整修复

## 🔧 新增功能列表
1. **🆕 模板列表字段类型** - 全新字段类型，专门用于模板文件选择
2. **🔧 修复AI动作模板字段选择** - 提示词设置选择"内置模板"时正确显示"提示模板字段"
3. **🔧 修复AI模型字段动态显示** - AI模型和模板列表字段正确参与动态显示逻辑
4. **🔧 修复下拉列表"请选择"选项** - 下拉列表的"请选择"选项现在始终可见
5. **🔧 修复z-index阻挡问题** - 模板文件选择不再阻挡动作列表

## 📋 必须执行的步骤

### 第1步：确认Obsidian已完全关闭
- 检查系统托盘中是否还有Obsidian图标
- 如果有，右键点击选择"退出"
- 等待5-10秒确保完全关闭

### 第2步：清理插件缓存（重要！）
1. **删除插件缓存目录**：
   ```
   C:\Code\Obsidian沙箱仓库\.obsidian\plugins\form-flow\.cache\
   ```
   （如果存在的话）

2. **删除Obsidian应用缓存**：
   - 按 `Win + R`，输入 `%APPDATA%`
   - 导航到 `Obsidian` 文件夹
   - 删除其中的缓存文件（保留配置文件）

### 第3步：重启Obsidian
1. **启动Obsidian**
2. **打开沙箱仓库**：`C:\Code\Obsidian沙箱仓库\`
3. **确认插件已加载**：
   - 设置 → 社区插件
   - 确认 "Form Flow" 插件显示为已启用

### 第4步：测试新功能

#### 测试1：AI动作模板字段选择修复
1. 打开任何带有AI调用动作的表单编辑界面
2. 在AI动作设置中，将"提示词设置"选择为"内置模板"
3. **确认"模板文件设置"现在显示为"提示模板字段"选项**
4. 可以选择表单中的模板列表字段作为模板来源

#### 测试2：模板列表字段类型
1. 创建新的表单文件（.cform）
2. 在表单编辑器中添加字段
3. **查找"模板列表"字段类型** - 这是新增的字段类型
4. 配置字段属性并保存

#### 测试3：下拉列表"请选择"选项修复
1. 在任何包含下拉选择字段的表单中
2. 选择一个选项，然后重新打开下拉列表
3. **确认"请选择"选项始终可见**，可以重复选择来清空选择

#### 测试4：AI模型字段动态显示
1. 创建包含AI模型列表字段的表单
2. 设置字段的默认模型或启用自动选择
3. 预览表单，确认该字段不显示在表单界面中

#### 测试5：z-index修复
1. 打开任何带有AI调用动作的表单
2. 在AI调用动作设置中展开"模板文件"下拉框
3. 确认下拉框不再遮挡下方的动作列表

## 🚨 如果仍然看不到新功能

### 方案1：强制刷新插件
1. 设置 → 社区插件
2. 找到 "Form Flow" 插件
3. 点击"禁用"，等待2秒
4. 点击"启用"

### 方案2：重置插件配置
1. 关闭Obsidian
2. 删除：`C:\Code\Obsidian沙箱仓库\.obsidian\plugins\form-flow\data.json`
3. 重启Obsidian
4. 重新配置插件设置

### 方案3：完全重装插件
1. 关闭Obsidian
2. 删除整个目录：`C:\Code\Obsidian沙箱仓库\.obsidian\plugins\form-flow\`
3. 重新复制插件文件
4. 重启Obsidian

## 📝 验证新功能的标志

### ✅ 成功标志
- 在字段类型列表中能看到 **"模板列表"** 选项
- 模板文件下拉框不再遮挡界面元素
- AI模型字段有固定值时不显示在表单中
- 插件版本显示为最新构建时间

### ❌ 问题标志
- 字段类型列表中没有 "模板列表" 选项
- 模板文件选择仍然遮挡动作列表
- AI模型字段即使有默认值也显示在表单中

## 🔧 技术细节
- **构建时间**：2025/8/20 2:39:16
- **文件大小**：main.js (876,396 字节)
- **包含功能**：
  - AI动作模板字段选择双模式
  - AI模型/模板列表字段动态显示逻辑
  - 下拉列表"请选择"选项可见性修复
  - template_list 枚举、TemplateListControl 组件
  - z-index层级优化

## 📞 如果问题持续存在
如果按照以上步骤操作后仍然看不到新功能，请检查：
1. Obsidian版本是否兼容
2. 是否有其他插件冲突
3. 插件文件是否有权限问题
4. 系统是否有防病毒软件阻止文件更新

---

**重要提醒**：由于Obsidian的插件缓存机制，**必须完全关闭Obsidian并重新启动**才能看到新功能。简单的插件重启可能不足以清除所有缓存。
